<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	 			
<mapper namespace="NoticeDAO">
	<select id="getNoticeList" resultType="notice">
		SELECT row_number() over(ORDER BY noticeDate) as noticeIdx, n.*
		FROM notice n
		<trim prefix="WHERE" prefixOverrides="AND|OR">
			<if test="keyword != null and keyword != ''">
				<if test="searchType == 'noticeTitle'">
					AND noticeTitle like CONCAT('%', #{keyword}, '%')
				</if>
				<if test="searchType == 'noticeContent'">
					AND noticeContent like CONCAT('%', #{keyword}, '%')
				</if>
				<if test="searchType == 'noticeWriter'">
					AND noticeWriter like CONCAT('%', #{keyword}, '%')
				</if>
			</if>
		</trim>
		ORDER BY noticeIdx DESC
		LIMIT #{startList}, #{listSize};
	</select>
	
	<select id="getNoticeListCnt" resultType="int">
		SELECT count(*)
		FROM notice
		<trim prefix="WHERE" prefixOverrides="AND|OR">
			<if test="keyword != null and keyword != ''">
				<if test="searchType == 'noticeTitle'">
					AND noticeTitle like CONCAT('%', #{keyword}, '%')
				</if>
				<if test="searchType == 'noticeContent'">
					AND noticeContent like CONCAT('%', #{keyword}, '%')
				</if>
				<if test="searchType == 'noticeWriter'">
					AND noticeWriter like CONCAT('%', #{keyword}, '%')
				</if>
			</if>
		</trim>
	</select>
	
	<select id="getNotice" resultType="notice">
		SELECT *
		FROM notice
		WHERE noticeId = #{noticeId}
	</select>
	
	<insert id="insertNotice">
		INSERT INTO notice
		VALUES(#{noticeId}, #{noticeWriter}, default, #{noticeTitle}, #{noticeContent}, null, default)
	</insert>
	
	<update id="updateNotice">
		UPDATE notice
		SET noticeTitle = #{noticeTitle}, noticeContent = #{noticeContent}
		WHERE noticeId = #{noticeId}
	</update>
	
	<delete id="deleteNotice">
		DELETE FROM notice
		WHERE noticeId = #{noticeId}
	</delete>
</mapper>