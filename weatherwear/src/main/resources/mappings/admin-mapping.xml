<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	 			
<mapper namespace="AdminDAO">
	<select id="getAdminList" resultType="admin">
		SELECT row_number() over(ORDER BY adminRegDate) as adminIdx, a.*
		FROM admin a
		<trim prefix="WHERE" prefixOverrides="AND|OR">
			<if test="keyword != null and keyword != ''">
				<if test="searchType == 'adminId'">
					AND adminId like CONCAT('%', #{keyword}, '%')
				</if>
				<if test="searchType == 'adminName'">
					AND adminName like CONCAT('%', #{keyword}, '%')
				</if>
				<if test="searchType == 'gradeId'">
					AND gradeId = #{keyword}
				</if>
			</if>
		</trim>
		ORDER BY adminIdx DESC
		LIMIT #{startList}, #{listSize}
	</select>
	
	<select id="getAdminListCnt" resultType="int">
		SELECT count(*)
		FROM admin
		<trim prefix="WHERE" prefixOverrides="AND|OR">
			<if test="keyword != null and keyword != ''">
				<if test="searchType == 'adminId'">
					AND adminId like CONCAT('%', #{keyword}, '%')
				</if>
				<if test="searchType == 'adminName'">
					AND adminName like CONCAT('%', #{keyword}, '%')
				</if>
				<if test="searchType == 'gradeId'">
					AND gradeId = #{keyword}
				</if>
			</if>
		</trim>
	</select>
	
	<select id="getAdmin" resultType="admin">
		SELECT *
		FROM admin
		WHERE adminId = #{adminId}
	</select>
	
	<insert id="insertAdmin">
		INSERT INTO admin
		VALUES(#{adminId}, #{adminPwd}, default, #{adminName}, #{adminNum}, default, #{gradeId})
	</insert>
	
	<update id="updateAdmin">
		UPDATE admin
		SET adminPwd = #{adminPwd}, adminNum = #{adminNum}, gradeId = #{gradeId}
		<if test="adminPwdDate != null">
			, adminPwdDate = default
		</if>
		WHERE adminId = #{adminId}
	</update>
	
	<delete id="deleteAdmin">
		DELETE FROM admin
		WHERE adminId = #{adminId}
	</delete>
</mapper>